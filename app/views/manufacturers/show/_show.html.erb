
<% content_for :show_content do %>

	<%= render('layouts/shared/show_item_basic_info',
		fields: [
			[:name]
		]
	) %>

	<%= render 'manufacturers/show/add_goods', obj: @record %>

	<%= render('layouts/shared/items_table',

		object: @for_impexpcompaniestable,

		fields: {
			impexpcompany: [
				company_name: {}
			],
			local_taric: [
				kncode: {
					fill_if_empty: true,
					call_decorator: :num_to_kncode,
					is_link: true,
					clipboard_button: true,
                    tooltip: :description
				}
			],
			incoterm: [
				shortland: {
					fill_if_empty: true,
					clipboard_button: true
				}
			],
			trade_type: [
				type: {
					fill_if_empty: true
				}
			],
			invoices_correct: {
				fill_if_empty: true,
				call_decorator: :bool_to_human
			},
			person: [
				full_name: {
					fill_if_empty: true,
					is_link: true
				},
				email: {
					is_email: true
				}
			]
		},

		options: [
			caption: Impexpcompany.model_name.human,
			head: true,
			foot: true,
			html_options: {
				main_class: "shrinked"
			},
			not_editable: true,
			change_on_smallscreen: true
		]

	) %>

	<% if !@record.note.blank? %>

		<%= render(
			'/layouts/shared/items_table/note_window',
			caption: t('activerecord.attributes.good.note'),
			content: simple_format(@record.note, {}, wrapper_tag: :span),
			foot_content: ""
		) %>

	<% end %>

	<%= render('layouts/shared/items_table',

		object: @for_tarictable,

		fields: {
			local_taric: [
				kncode: {
					call_decorator: :num_to_kncode,
					is_link: true,
					clipboard_button: true,
					tooltip: :description
				},
				description: {

				}
			]
		},

		options: [
			caption: t('activerecord.models.local_taric'),
			head: {
				span: 2
			},
			foot: true,
			html_options: {
				main_class: "shrinked",
				id: "manufacturers-local_taric"
			},
			not_editable: true,
			change_on_smallscreen: true
		]

	) %>

	<% 
		fields_for_goodstable = {
			ident: {
				is_link: {
					remote: true
				},
				tooltip: :reason_and_note,
	            issues: :patale,
	            image_previews: :good_images,
	            link: :link
			},
			description: {

			},
			local_taric: [
				kncode: {
					call_decorator: :num_to_kncode,
					is_link: true,
					clipboard_button: true,
					tooltip: :description
				}
			]
		}

		if @record.impexpcompanies.size > 1

			fields_for_goodstable.merge!(
				impexpcompanies: [
					company_name: { 
						#is_link: true
					}
				]
			)

		end

		goodstable_has_issues = @for_goodstable.any? { |good| !good.issues.blank? }
		if goodstable_has_issues

			fields_for_goodstable.merge!(
				issues: [
					name_field: { 
						is_link: true
					}
				]
			)

		end


	%>

	<%= render('layouts/shared/items_table',

		object: @for_goodstable,

		fields: fields_for_goodstable,

		options: [
			caption: true,
			head: true,
			foot: true,
			html_options: {
				main_class: "shrinked"
			},
			row_danger: {
				uncomplete: true
			},
			not_editable: true,
			change_on_smallscreen: true
		]

	) %>


<% end %>
