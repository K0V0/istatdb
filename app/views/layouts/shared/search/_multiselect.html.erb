<%
select_text = ""
key = multiselect_filter_key(obj: obj)
selected = get_selected_multiselect(filter_key: key)
selected_size = selected.try(:size)
show_button = false
disabled_class = obj.size == 0 ? "disabled" : ""
c_name = obj.first.class.name.downcase

case selected_size
when nil
    select_text = obj.first.nil? ? t("goods_search.na") : t("goods_search.#{c_name}_prompt")
when 0
    select_text = t("goods_search.#{c_name}_prompt")
when 1
    if selected.first == 0
        select_text = t('goods_search.manufacturer_prompt')
    else
        select_text = obj.find(selected.first).name_field
        show_button = true
    end
when 2..4
    select_text = "<b>#{selected_size}</b> #{t('goods_search.manufacturer_prompt_few')}"
    show_button = true
else
    select_text = "<b>#{selected_size}</b> #{t('goods_search.manufacturer_prompt_many')}"
    show_button = true
end
%>

<div class="multiselect <%= disabled_class %>" id="<%= key %>" tabindex="0">
    <span> <%= select_text.html_safe %> </span>
    <div>
        <span class="select_reset_button">
            <button class="button <%= "novisible" if !show_button %>" type="button" id="reset_multiselect">
                <%= t('goods_search.manufacturer_prompt_button_reset') %>
            </button>
            <button class="button novisible" type="button" id="confirm_multiselect">
                <b> <%= t('goods_search.manufacturer_prompt_button_done') %> </b>
            </button>
        </span>
        <%= render_multiselect(obj: obj) %>
    </div>
</div>
